# トラブルシューティング

## エラーコード一覧

| コード | 種別 | 原因 | 対処法 |
|--------|------|------|--------|
| E001 | テンプレート不存在 | 指定されたテンプレートファイルが見つからない | パスを確認、ファイルの存在を確認 |
| E002 | データファイル不存在 | 指定されたデータファイルが見つからない | パスを確認、ファイルの存在を確認 |
| E003 | データ形式エラー | JSON/YAMLの構文エラー | 構文を確認、オンラインバリデータで検証 |
| E004 | 書き込み権限なし | 出力先ディレクトリに書き込めない | 権限を確認、別の出力先を指定 |
| E005 | ファイル既存 | 出力ファイルが既に存在する | `--force`オプションで上書き |
| E006 | テンプレート不正 | 有効なPPTXファイルではない | ファイル形式を確認 |

## 警告コード一覧

| コード | 種別 | 動作 |
|--------|------|------|
| W001 | 画像不存在 | スキップして続行 |
| W002 | 表データ空 | 表を生成しない |
| W003 | レイアウト範囲外 | デフォルト(1)を使用 |
| W004 | コンテンツ長すぎ | 警告を表示（500文字以上） |

## よくある問題

### Q: 日本語が文字化けする

**A:** python-pptxは日本語をUTF-8で正しく処理します。データファイルがUTF-8で保存されているか確認してください。

```bash
# ファイルのエンコーディングを確認
file data.json
# UTF-8 text と表示されればOK
```

### Q: テンプレートのフォントが変わってしまう

**A:** プレースホルダー置換はrun単位で行われ、フォーマットは保持されます。ただし、テキスト全体を置換する場合は段落レベルの置換になることがあります。

対処法:
- テンプレート内のプレースホルダーは単独のテキストボックスに配置
- フォント設定はスライドマスターで定義

### Q: YAMLファイルが読み込めない

**A:** PyYAMLがインストールされていません。

```bash
cd .claude/skills/pptx-from-template
uv add pyyaml
```

### Q: 表のセル幅が均等でない

**A:** 現在の実装では表の列幅は均等に配分されます。カスタム幅が必要な場合は、テンプレートに事前に表を配置してプレースホルダー置換を使用してください。

### Q: 画像が表示されない

**A:** 以下を確認:
1. 画像パスが正しいか（相対パス・絶対パス）
2. 画像ファイルが存在するか
3. サポートされている形式か（PNG, JPG, GIF等）

### Q: 既存ファイルを上書きできない

**A:** 安全のため、デフォルトでは上書きしません。`--force`オプションを使用:

```bash
uv run python -m scripts.generate_pptx \
  --data data.json \
  --output output.pptx \
  --force
```

## FAQ

### Q: 対応しているPythonバージョンは？

A: Python 3.11以上が必要です。

### Q: グラフは生成できますか？

A: 現バージョンではグラフ生成機能はありません。画像として事前に作成し、`image`フィールドで挿入してください。

### Q: 複数のテンプレートをマージできますか？

A: 現バージョンでは未対応です。将来の拡張として検討中です。

### Q: PDFに変換できますか？

A: 現バージョンでは未対応です。生成されたPPTXをPowerPoint等で開いてエクスポートしてください。

## デバッグ方法

詳細なエラー情報を得るには、Pythonから直接実行:

```python
from scripts.generate_pptx import generate_pptx

try:
    result_path, warnings, slide_info = generate_pptx(
        template_path="template.pptx",
        data_path="data.json",
        output_path="output.pptx",
    )
    print(f"成功: {result_path}")
    for w in warnings:
        print(f"警告: {w}")
except Exception as e:
    print(f"エラー: {e}")
    import traceback
    traceback.print_exc()
```
